<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="img/favicon.ico">

    <title>KumNum Publishing Online Report</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/overlay.css" rel="stylesheet">
    <link href="css/dashboard.css" rel="stylesheet">
    <link href="css/pricing.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
  </head>

  <body>
    <div class="overlay" id="overlay"></div>

    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">ร้านหนังสือ "คำนำ" ออนไลน์</a>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
          <div class="sidebar-sticky">
            <ul class="nav flex-column" id="menu-sidebar">
              <!-- Dynamically load sidebar menu item -->
            </ul>
            <!-- Sidebar 2nd section
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
              <span>Saved reports</span>
              <a class="d-flex align-items-center text-muted" href="#">
                <span data-feather="plus-circle"></span>
              </a>
            </h6>
            <ul class="nav flex-column mb-2">
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Current month
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Last quarter
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Social engagement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Year-end sale
                </a>
              </li>
            </ul> - end of sidebar 2nd section -->
          </div>
        </nav>

        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
          <div id="panel-content">
            <h2 id="panel-header"></h2>
            <p id="panel-description"></p>
          </div>
        </main>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-slim.min.js"><\/script>')</script>
    <script src="js/popper.min.js"></script>
    <script src="js/holder.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>

    <!-- manUtils JavaScript -->
    <script src="js/manutils.js"></script>

    <!-- Dashboard JavaScript -->
    <script type="text/javascript">
      var menuId = (manUtils.getParam('id') == null || manUtils.getParam('id') == "") ? 'main-dashboard' : manUtils.getParam('id');
      var key = manUtils.getParam('key');
      var globalVars = null;
      var keyOwner = null;
      var arrProducts = null;
      var arrSales = null;

      function init() {

        showSidebarMenu(menuId);

        // Show Panel Content
        var iPanel = document.getElementById('panel-content');
        switch (menuId) {
          case 'main-dashboard': showDashbord(iPanel); break;
          case 'main-profile': showProfile(iPanel); break;
          case 'main-shop': showShop(iPanel); break;
          case 'main-book': showBook(iPanel); break;
          default:
        }
        document.getElementById('overlay').remove();
      }

      function loadContacts(contactId) {
        // GET Author Info
        fetch('https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc/tabs/Contacts/ContactId/*' + contactId + '*')
        .then((response) => {
            return response.json();
        })
        .then((myJson) => {
          keyOwner = myJson[0];


          if (manUtils.getParam('id') == 'main-dashboard'
              || manUtils.getParam('id') == 'main-book' ) {
            loadProducts(contactId);
          } else {
            init();
          }
        })
        .catch((error) => { console.log(error); });
      }
      function loadProducts(contactId) {
        var fetchUrl = 'https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc/tabs/Products';
        if (contactId) fetchUrl += '/ContactId/*' + contactId + '*';
        //if (true) fetchUrl += '/Highlight/*Yes*'; // {DebugPoint}
        //if (manUtils.getParam('book')) fetchUrl += '/ProductId/*' + manUtils.getParam('book') + '*'; // {DebugPoint}

        // GET Author's Collections
        fetch(fetchUrl)
        .then((response) => {
            return response.json();
        })
        .then((myJson) => {
          arrProducts = myJson;
          loadSales(contactId);
        })
        .catch((error) => { console.log(error); });
      }
      function loadSales(contactId) {
        var fetchUrl = 'https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc/tabs/Sales';
        //if (contactId) fetchUrl += '/ContactId/*' + contactId + '*';
        //if (true) fetchUrl += '/Highlight/*Yes*'; // {DebugPoint}
        //if (manUtils.getParam('book')) fetchUrl += '/ProductId/*' + manUtils.getParam('book') + '*'; // {DebugPoint}

        // GET Author's Collections
        fetch(fetchUrl)
        .then((response) => {
            return response.json();
        })
        .then((myJson) => {
          arrSales = myJson;
          init();
        })
        .catch((error) => { console.log(error); });
      }
      function showBook(panel) {
        document.getElementById('panel-header').innerHTML = 'หนังสือ (' + arrProducts.length + ')';
        document.getElementById('panel-description').innerHTML = manUtils.getGlobalVars('guideBook');
        panel.appendChild(document.createElement('hr'));
        if (keyOwner && arrProducts) {

          var html = '';
          for (var i in arrProducts) {
            var data = {
              Title: arrProducts[i].Title,
              Description: arrProducts[i].Brief,
              imageURL: arrProducts[i].ImageFull,
              maxWidth: 280,
            };
            if (arrProducts[i].Available == 'No')
              data.Title += ' <div class="badge badge-danger">งดจำหน่าย</div>';
            else {
              data.Title += (arrProducts[i].PrivateSale == 'Yes')
                   ? ' <div class="badge badge-warning">ขายเป็นส่วนบุคคล</div>'
                   : ' <div class="badge badge-success">ขายเป็นสาธารณะ</div>';
            }
            html = '<h4>' + arrProducts[i].Price + ' บ.</h4>';
            html += '<p><ul class="list-group">';
              html += '<li class="list-group-item">ลิงค์สั่งซื้อ&nbsp;&nbsp;<i class="fa fa-globe fa-lg"></i>&nbsp;&nbsp;<a href="' + arrProducts[i].PrivateSaleURL + '">' + arrProducts[i].PrivateSaleURL + '</a></li>';
              html += '<li class="list-group-item">คิวอาร์โค้ด&nbsp;&nbsp;<i class="fa fa-qrcode fa-lg"></i>&nbsp;&nbsp;<a href="' + arrProducts[i].PrivateSaleURL + '">' + arrProducts[i].PrivateSaleURL + '</a></li>';
            html += '</ul></p>';
            data.Description += html;
            spawnMediaObject(panel, data);

            // HR
            panel.appendChild(document.createElement('hr'));
          }
        }
      }
      function showDashbord(panel) {
        document.getElementById('panel-header').innerHTML = 'รายงานสรุป';
        document.getElementById('panel-description').innerHTML = manUtils.getGlobalVars('guideDashboard');
        //panel.appendChild(document.createElement('hr'));

        var deck = document.createElement('div');
        deck.className = 'card-deck mb-3 text-center';
        panel.appendChild(deck);

        // Sales
        var data = {
          Title: 'ยอดจำหน่าย',
          Value: manUtils.formatNumber(1181, 0),
          Unit: 'เล่ม',
          Description: manUtils.getGlobalVars('loremShort'),
          Image: 'https://i.imgur.com/rndKXeC.jpg',
          Width: 120,
          Color: 'primary',
          Remark: 'นับเฉพาะรายการที่ชำระเงินเสร็จสมบูรณ์',
        };
        // Revenue
        spawnCard(deck, data);
        var data = {
          Title: 'ค่าลิขสิทธิ์รับแล้ว',
          Value: manUtils.formatNumber(22439, 0),
          Unit: 'บาท',
          Description: manUtils.getGlobalVars('loremShort'),
          Image: 'https://i.imgur.com/rndKXeC.jpg',
          Width: 120,
          Color: 'success',
          Remark: '% จากมูลค่าขายตามสัดส่วนค่าลิขสิทธิ์',
        };
        // Share
        spawnCard(deck, data);
        var data = {
          Title: 'ค่าลิขสิทธิ์รอรับ',
          Value: manUtils.formatNumber(0, 0),
          Unit: 'บาท',
          Description: manUtils.getGlobalVars('loremShort'),
          Image: 'https://i.imgur.com/rndKXeC.jpg',
          Width: 120,
          Color: 'dark',
          Remark: 'รอบจ่ายครั้งต่อไป 28 มีนาคม 2564',
        };
        spawnCard(deck, data);

        // Table of Sales Summary
        var hTableSum = document.createElement('h2');
        hTableSum.innerHTML = 'สรุปยอดจำหน่ายรายเล่ม';
        panel.appendChild(hTableSum);

        var pTableSum = document.createElement('p');
        pTableSum.innerHTML = manUtils.getGlobalVars('guideTableSaleSummary');
        panel.appendChild(pTableSum);

        var tableSum = document.createElement('table');
        tableSum.className = 'table table-sm';
        panel.appendChild(tableSum);

        html = '<thead><tr>'
          html += '<th class="text-center" scope="col">#</th>';
          html += '<th class="text-center" scope="col">ขายวันแรก</th>';
          html += '<th scope="col">ชื่อหนังสือ</th>';
          html += '<th class="text-center" scope="col">ยอดจำหน่าย (เล่ม)</th>';
          html += '<th class="text-right" scope="col">ราคาปก (บ.)</th>';
          html += '<th class="text-right" scope="col">สัดส่วนค่าลิขสิทธิ์ (%)</th>';
          html += '<th class="text-right" scope="col">ส่วนแบ่งรายได้ (บ.)</th>';
        html += '</tr></thead>';
        html += '<tbody>';
        var sumSales = 0;
        var sumShare = 0;
        for (var i in arrProducts) {
          html += '<tr>';
            html += '<td class="text-center" scope="row">' + Number(Number(i) + 1) +'</td>';
            html += '<td class="text-center">' + arrProducts[i].CreatedDate + '</td>';
            html += '<td>' + arrProducts[i].Title + '</td>';
            html += '<td class="text-center">' + arrProducts[i].Amount + '</td>';
            html += '<td class="text-right">' + arrProducts[i].Price + '</td>';
            html += '<td class="text-right">' + arrProducts[i].CopyrightRatio + '</td>';
            html += '<td class="text-right">' + manUtils.formatNumber(arrProducts[i].CopyrightShare, 0) + '</td>';
          html += '</tr>';
          sumSales += Number(arrProducts[i].Amount);
          sumShare += Number(arrProducts[i].CopyrightShare);
        }
        // Total Row
        html += '<tr>';
          html += '<td class="text-center" scope="row"></td>';
          html += '<td class="text-center"></td>';
          html += '<td>รวม</td>';
          html += '<td class="text-center"><h4>' + manUtils.formatNumber(sumSales, 0) + '</h4></td>';
          html += '<td class="text-right"></td>';
          html += '<td class="text-right"></td>';
          html += '<td class="text-right"><h4>' + manUtils.formatNumber(sumShare, 0) + '</h4></td>';
        html += '</tr>';
        html += '<tr>';
          html += '<td class="text-center" scope="row"></td>';
          html += '<td class="text-center"></td>';
          html += '<td></td>';
          html += '<td class="text-center"></td>';
          html += '<td class="text-right"></td>';
          html += '<td class="text-right"></td>';
          html += '<td class="text-right"></td>';
        html += '</tr>';
        html += '</tbody>'
        tableSum.innerHTML = html;

        // HR
        //panel.appendChild(document.createElement('hr'));

        // Chart Sale Summary
        var hChart = document.createElement('h2');
        hChart.innerHTML = 'ยอดจำหน่ายรายเล่มตามช่วงเวลา';
        panel.appendChild(hChart);

        var divPeriod = document.createElement('div');
        divPeriod.className = 'btn-toolbar mb-2 mb-md-0';
        var html = "";
        html += '<div class="btn-group mr-2">';
          html += '<button class="btn btn-sm btn-outline-secondary">รายวัน</button>';
          html += '<button class="btn btn-sm btn-outline-secondary">รายสัปดาห์</button>';
          html += '<button class="btn btn-sm btn-outline-secondary">รายเดือน</button>';
          html += '<button class="btn btn-sm btn-outline-secondary">รายปี</button>';
        html += '</div>';
        divPeriod.innerHTML = html;
        panel.appendChild(divPeriod);

        var canvas = document.createElement('canvas');
        canvas.height = "100";
        panel.appendChild(canvas);
        var ctx = canvas.getContext('2d');

        'use strict';

        window.chartColors = {
          red: 'rgb(255, 99, 132)',
          orange: 'rgb(255, 159, 64)',
          yellow: 'rgb(255, 205, 86)',
          green: 'rgb(75, 192, 192)',
          blue: 'rgb(54, 162, 235)',
          purple: 'rgb(153, 102, 255)',
          grey: 'rgb(201, 203, 207)'
        };

        window.randomScalingFactor = function() {
          return (Math.random() > 0.5 ? 1.0 : -1.0) * Math.random() * 100;
        };

    		var lineChartData = {
    			labels: ['1 สัปดาห์ก่อน', '6 วันก่อน', '5 วันก่อน', '4 วันก่อน', '3 วันก่อน', 'เมื่อวาน', 'วันนี้'],
    			datasets: [{
    				label: 'เล่ม #1',
    				borderColor: window.chartColors.red,
    				backgroundColor: window.chartColors.red,
    				fill: false,
    				data: [
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor()
    				],
    				yAxisID: 'y-axis-1',
    			}, {
    				label: 'เล่ม #2',
    				borderColor: window.chartColors.green,
    				backgroundColor: window.chartColors.green,
    				fill: false,
    				data: [
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor()
    				],
    				yAxisID: 'y-axis-2'
    			}, {
    				label: 'เล่ม #3',
    				borderColor: window.chartColors.blue,
    				backgroundColor: window.chartColors.blue,
    				fill: false,
    				data: [
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor(),
    					randomScalingFactor()
    				],
    				yAxisID: 'y-axis-3'
    			}]
    		};

        window.myLine = Chart.Line(ctx, {
          data: lineChartData,
          options: {
            responsive: true,
            hoverMode: 'index',
            stacked: false,
            title: {
              display: true,
              text: manUtils.getGlobalVars('guideSaleSummary'),
            },
            scales: {
              yAxes: [{
                type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
                display: true,
                position: 'left',
                id: 'y-axis-1',
              }, {
                type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
                display: false,
                position: 'left',
                id: 'y-axis-2',
              }, {
                type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
                display: true,
                position: 'right',
                id: 'y-axis-3',

                // grid line settings
                gridLines: {
                  drawOnChartArea: false, // only want the grid lines for one axis to show up
                },
              }],
            }
          }
        });

        // HR
        panel.appendChild(document.createElement('hr'));

        var hTable = document.createElement('h2');
        hTable.innerHTML = 'รายการจำหน่ายล่าสุด';
        panel.appendChild(hTable);

        var pTable = document.createElement('p');
        pTable.innerHTML = manUtils.getGlobalVars('guideLatestSale');
        panel.appendChild(pTable);

        var table = document.createElement('table');
        table.className = 'table table-sm';
        panel.appendChild(table);

        html = '<thead><tr>'
          html += '<th class="text-center" scope="col">#</th>';
          html += '<th class="text-center" scope="col">วันที่</th>';
          html += '<th scope="col">ชื่อหนังสือ</th>';
          html += '<th class="text-center" scope="col">ยอดจำหน่าย (เล่ม)</th>';
          html += '<th class="text-right" scope="col">ราคา (บ.)</th>';
          html += '<th class="text-right" scope="col">มูลค่าการขาย (บ.)</th>';
          html += '<th class="text-right" scope="col">ส่วนแบ่งรายได้ (บ.)</th>';
        html += '</tr></thead>';
        html += '<tbody>';
        for (var i in arrSales) {
          html += '<tr>';
            html += '<td class="text-center" scope="row">' + Number(Number(i) + 1) +'</td>';
            html += '<td class="text-center">' + arrSales[i].PaymentDate + '</td>';
            html += '<td>' + arrSales[i].Title + '</td>';
            html += '<td class="text-center">' + arrSales[i].Amount + '</td>';
            html += '<td class="text-right">' + arrSales[i].Price + '</td>';
            html += '<td class="text-right">' + arrSales[i].SubTotal + '</td>';
            html += '<td class="text-right">' + arrSales[i].CopyrightShare + '</td>';
          html += '</tr>';
          if (i >= 20)
            break;
        }
        html += '</tbody>'
        table.innerHTML = html;

      }
      function showProfile(panel) {
        document.getElementById('panel-header').innerHTML = 'ข้อมูลส่วนตัว';
        document.getElementById('panel-description').innerHTML = manUtils.getGlobalVars('guideProfile');
        panel.appendChild(document.createElement('hr'));
        if (keyOwner) {
          var data = {
            Title: keyOwner.Title + keyOwner.FirstName + ' ' + keyOwner.LastName,
            Description: keyOwner.Biography,
            imageURL: keyOwner.ImageProfile,
            maxWidth: 300,
          };

          var html = '';
          html += '<ul class="list-group">';
            html += '<li class="list-group-item"><i class="fa fa-phone fa-lg"></i>&nbsp;&nbsp;' + keyOwner.Phone + ' <div class="badge badge-danger">งดเผยแพร่</div></li>';
            html += '<li class="list-group-item"><i class="fa fa-envelope fa-lg"></i>&nbsp;&nbsp;' + keyOwner.Email + ' <div class="badge badge-success">เผยแพร่</div></li>';
            html += '<li class="list-group-item"><i class="fa fa-money fa-lg"></i>&nbsp;&nbsp;' + keyOwner.BankAccountId + ' ' + keyOwner.BankName + ' <div class="badge badge-danger">งดเผยแพร่</div></li>';
          html += '</ul>';
          data.Description += html;
          spawnMediaObject(panel, data);

          // HR
          panel.appendChild(document.createElement('hr'));
        }
      }
      function showShop(panel) {
        document.getElementById('panel-header').innerHTML = 'ร้านหนังสือ';
        document.getElementById('panel-description').innerHTML = manUtils.getGlobalVars('guideShop');
        panel.appendChild(document.createElement('hr'));
        if (keyOwner) {
          // Private Shop
          var data = {
            Title: "ร้านขายเป็นส่วนบุคคล",
            Description: manUtils.getGlobalVars('guidePrivateShop'),
            imageURL: keyOwner.PrivateShopURL,
            maxWidth: 250,
          };
          data.Title += ' <div class="badge badge-warning">ขายเป็นส่วนบุคคล</div>';

          var html = '';
          html += '<p><ul class="list-group">';
            html += '<li class="list-group-item">ลิงค์หน้าร้าน&nbsp;&nbsp;<i class="fa fa-globe fa-lg"></i>&nbsp;&nbsp;<a href="' + keyOwner.PrivateShopURL + '">' + keyOwner.PrivateShopURL + '</a></li>';
            html += '<li class="list-group-item">คิวอาร์โค้ด&nbsp;&nbsp;<i class="fa fa-qrcode fa-lg"></i>&nbsp;&nbsp;<a href="' + keyOwner.PrivateShopURL + '">' + keyOwner.PrivateShopURL + '</a></li>';
          html += '</ul></p>';
          html += '<div class="alert alert-danger">' + manUtils.getGlobalVars('guidePrivateShopURL') + '</div>';
          data.Description += html;
          spawnMediaObject(panel, data);

          // HR
          panel.appendChild(document.createElement('hr'));

          // Public Shop
          var data = {
            Title: "ร้านขายเป็นสาธารณะ",
            Description: manUtils.getGlobalVars('guidePublicShop'),
            imageURL: keyOwner.PublicShopURL,
            maxWidth: 250,
          };
          data.Title += ' <div class="badge badge-success">ขายเป็นสาธารณะ</div>';

          var html = '';
          html += '<p><ul class="list-group">';
            html += '<li class="list-group-item">ลิงค์หน้าร้าน&nbsp;&nbsp;<i class="fa fa-globe fa-lg"></i>&nbsp;&nbsp;<a href="' + keyOwner.PublicShopURL + '">' + keyOwner.PublicShopURL + '</a></li>';
            html += '<li class="list-group-item">คิวอาร์โค้ด&nbsp;&nbsp;<i class="fa fa-qrcode fa-lg"></i>&nbsp;&nbsp;<a href=' + keyOwner.PublicShopURL + '">' + keyOwner.PublicShopURL + '</a></li>';
          html += '</ul></p>';
          data.Description += html;
          spawnMediaObject(panel, data);
        }
      }

      function showSidebarMenu(menuId) {
        var menuItems = [
          {icon: 'fa-home', caption: 'สรุปรายงาน', name: 'main-dashboard', href: 'index.html?id=main-dashboard&key=' + manUtils.getParam('key')},
          {icon: 'fa-user', caption: 'ข้อมูลส่วนตัว', name: 'main-profile', href: 'index.html?id=main-profile&key=' + manUtils.getParam('key')},
          {icon: 'fa-shopping-cart', caption: 'ร้านหนังสือ', name: 'main-shop', href: 'index.html?id=main-shop&key=' + manUtils.getParam('key')},
          {icon: 'fa-book', caption: 'หนังสือ', name: 'main-book', href: 'index.html?id=main-book&key=' + manUtils.getParam('key')},
        ];
        var html = "";

        for (var i in menuItems) {
          var item = menuItems[i];
          html += '<li class="nav-item">';
            if (item.name == menuId)
              html += '<a class="nav-link active" href="' + item.href + '">';
            else html += '<a class="nav-link" href="' + item.href + '">';
              html += '<i class="fa ' + item.icon + ' fa-lg"></i>&nbsp;&nbsp;';
              html += item.caption;
              html += (item.name == menuId) ? '<span class="sr-only">(current)</span>' : '';
            html += '</a>';
          html += '</li>';
        }
        document.getElementById('menu-sidebar').innerHTML = html;
      }
      function spawnCard(deck, data) {
        var html = '';

        html += '<div class="card mb-4 box-shadow">';
          html += '<div class="card-header text-white bg-' + data.Color + '">';
            html += '<h4 class="my-0 font-weight-normal">' + data.Title + '</h4>';
          html += '</div>';
          html += '<div class="card-body">';
            html += '<h1 class="card-title pricing-card-title">' + data.Value + ' <small><small>' + data.Unit + '</small></small></h1>';
            //html += '<p class="card-text">' + data.Description + '</p>';
            html += '<p class="card-text"><small class="text-muted">' + data.Remark + '</small></p>';
          html += '</div>';
        html += '</div>';

        deck.innerHTML += html;
      }

      function spawnMediaObject(panel, data) {
        var media = document.createElement('div');
        media.className = "media";
        var img = document.createElement('img');
        img.className = "mr-3";
        img.src = data.imageURL;
        img.style = "max-width:" + data.maxWidth + 'px;';
        media.appendChild(img);
        var mediaBody = document.createElement('div');
        media.appendChild(mediaBody);
        var h = document.createElement('h5');
        h.className = "mt-0";
        h.innerHTML = data.Title;
        mediaBody.appendChild(h);
        var mediaText = document.createElement('div');
        mediaText.innerHTML = '<p>' + data.Description + '</p>';
        mediaBody.appendChild(mediaText);

        panel.appendChild(media);
      }
      window.addEventListener('load', (event) => {
        // GET GlobalVars
        // -- GET Author Info
        fetch('https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc/tabs/GlobalVars')
        .then((response) => { return response.json(); })
        .then((myJson) => {
          globalVars = myJson;

          loadContacts(manUtils.getParam('key'));
        })
        .catch((error) => { console.log(error); });
      });
    </script>
  </body>
</html>
